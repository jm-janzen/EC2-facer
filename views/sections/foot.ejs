<div id='gitlog'></div>
<script type='text/javascript'>

    var counter   = setInterval(timer, 1);
    function timer() {
        var day           = (24 * 60 * 60 * 1000);
        var now           = new Date();
        var graduation    = new Date('April 19, 2016');
        var remainingMili =
            Math.round(Math.abs(now.getTime() - graduation.getTime()));
        var remainingDays =
            Math.round(Math.abs(now.getTime() - graduation.getTime()) / (day));
        $('#timer').html(remainingMili
            + 'ms until graduation (or '
            +  remainingDays + ' days)');
    }
    $.ajax({
        url: '/getGitLog',
        success: function (result) {
            $('div#gitlog').attr('data-content', result.content);
        },
        error: function (error) {
            console.log('error', error);
        }
    });

    $( document ).ready(function () {
        $('div#navbar a').click(function (event) {
            if ((which = $(this)
              .not('#timer, .navbar-brand')
              .text()) !== '') {
                navigate(which);
            }
        });

        // collapse navbar on click anywhere (mobile)
        $(document).click(function () {
            $('.navbar-collapse').collapse('hide');
        });

        var navs = ['home', 'projects', 'about', 'contact'];
        var here = 0;
        $(document).keydown(function (event) {
            switch (event.which) {
                case 74: // j: scroll down
                    window.scrollBy(0, 30);
                    break;
                case 75: // k: scroll up
                    window.scrollBy(0, -30);
                    break;
                case 72: // h: prev nav
                    here = here <= 0 ? 3 : here - 1;
                    var to  = navs[here % navs.length];
                    navigate(to);
                    break;
                case 76: // l: next nav
                    here = here >= navs.length ? 0 : here + 1;
                    var to = navs[here % navs.length];
                    navigate(to);
                    break;
            }
        });
    });

    function navigate(to) {
        // remove present content, and load new from server
        $.ajax({
            url: '/body/' + to,
            success: function (result) {
                $('div.body')
                  .empty();
                $('ul.nav li')
                  .siblings('.active')
                  .removeClass('active');
                $('ul.nav li a:contains("' + to + '")')
                  .parent()
                  .addClass('active');
                $('div.body')
                  .append(result.data.content);
                $('div.page-header h1')
                  .html(result.data.subject);
            },
            error: function (result) {
                console.error('Error:', result);
            }
        });
    }
</script>
</body>

